<!DOCTYPE html><html lang="en"><head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>CSS Books</title>
<style>
.head h1 { padding: 1em 0 }
span.minor { letter-spacing: 0; color: black; font-size: 0.8em; font-weight: normal }

div.example {
  border-left: 0.3em solid black;
  margin: 0;
}
.code-example {
  text-align: right;
  float: left;
  width: 6em;
  margin-left: -7em;
}
a { text-decoration: none }
a.pass { color: green }
a.fail { color: red }
a.unclear, a.almost { color: orange }
</style>
<link rel="stylesheet" href="http://www.whatwg.org/style/specification" type="text/css">

<body class="draft">

<div class="head">
  <p><a href="http://www.whatwg.org/" class="logo"><img width="100" src="http://resources.whatwg.org/logo.svg" alt="WHATWG" height="100"></a></p>
	<h1>CSS Books</h1>
	
	<h2 class="no-num no-toc" id="soon-to-become-a-living-standard-—-last-updated-21-october-2013"><span class="minor">[soon to become a]</span> Living Standard — Last Updated 21 October 2013</h2>
	
	<dl>
		<dt>This version:
		<dd><!--begin-link--><a href="http://books.spec.whatwg.org/">http://books.spec.whatwg.org/</a><!--end-link-->
		
	
		<dt>Editor:
		<dd class="vcard">
			<span class="fn">Håkon Wium Lie</span>,
			<span class="org">Opera Software</span>,
			<span class="email">howcome@opera.com</span>

		<dt>Participate:</dt>
		<dd><a href="http://www.whatwg.org/mailing-list">whatwg@whatwg.org</a></dd>
		<dd><a href="http://lists.w3.org/Archives/Public/www-style/">www-style@w3.org</a></dd>

<dd><a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=WHATWG&amp;component=Books">file a bug</a> (<a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=WHATWG&amp;component=Books&amp;resolution=---">open bugs</a>)</dd>


	</dl>

<p class="copyright"><a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/"><img src="http://i.creativecommons.org/p/zero/1.0/80x15.png" alt="CC0"></a>To the extent possible under law, the editor has waived all copyright and related or neighboring rights to this work. In addition, as of 21 October 2013, the editor has made this specification available under the
<a rel="license" href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0">Open Web Foundation Agreement Version 1.0</a>, which is available at <!--begin-link--><a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0">http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0</a><!--end-link-->.

</div>

<h2 class="no-num no-toc" id="abstract">Abstract</h2>

<p>This specification defines features often used when printing books or magazines. Using this functionality, documents written in HTML can be presented in a book-like manner, either on screen or on paper. Real books are being published with functionality described in this specification. 

<h2 class="no-num no-toc" id="status">Status</h2>

<p>This specification is in the process of establishing itself in WHATWG. As such, the term "Living Standard" indicates a goal. However, most of this specification has been interoperably implemented and is in daily use by publishers. Implementation coverage is <a href="http://people.opera.com/howcome/2013/tests/books/coverage.html">documented here</a>.

<h2 class="no-num no-toc" id="table-of-contents">Table of Contents</h2>


<!--begin-toc-->
<ol class="toc">
 <li><a href="#goals" class="no-num">Goals</a></li>
 <li><a href="#conformance"><span class="secno">1 </span>Conformance</a></li>
 <li><a href="#running-headers-and-footers"><span class="secno">2 </span>Running headers and footers</a>
  <ol>
   <li><a href="#named-strings"><span class="secno">2.1 </span>Named strings</a>
    <ol>
     <li><a href="#setting-named-strings:-the-'string-set'-property"><span class="secno">2.1.1 </span>Setting named strings: the 'string-set' property</a></li>
     <li><a href="#using-named-strings"><span class="secno">2.1.2 </span>Using named strings</a></ol></li>
   <li><a href="#running-elements"><span class="secno">2.2 </span>Running elements</a></ol></li>
 <li><a href="#leaders"><span class="secno">3 </span>Leaders</a></li>
 <li><a href="#cross-references"><span class="secno">4 </span>Cross-references</a>
  <ol>
   <li><a href="#the-''target-counter''-and-''target-counters''-values"><span class="secno">4.1 </span>The ''target-counter'' and ''target-counters'' values</a></li>
   <li><a href="#the-''target-text''-value"><span class="secno">4.2 </span>The ''target-text'' value</a></ol></li>
 <li><a href="#footnotes"><span class="secno">5 </span>Footnotes</a>
  <ol>
   <li><a href="#turning-elements-into-footnotes"><span class="secno">5.1 </span>Turning elements into footnotes</a></li>
   <li><a href="#the-footnote-area"><span class="secno">5.2 </span>The footnote area</a></li>
   <li><a href="#footnote-calls"><span class="secno">5.3 </span>Footnote calls</a></li>
   <li><a href="#footnote-markers"><span class="secno">5.4 </span>Footnote markers</a></li>
   <li><a href="#counting-footnotes"><span class="secno">5.5 </span>Counting footnotes</a></li>
   <li><a href="#laying-out-footnotes"><span class="secno">5.6 </span>Laying out footnotes</a></ol></li>
 <li><a href="#sidenotes"><span class="secno">6 </span>Sidenotes</a></li>
 <li><a href="#bookmarks"><span class="secno">7 </span>Bookmarks</a>
  <ol>
   <li><a href="#'bookmark-level'"><span class="secno">7.1 </span>'bookmark-level'</a></li>
   <li><a href="#'bookmark-label'"><span class="secno">7.2 </span>'bookmark-label'</a></li>
   <li><a href="#'bookmark-state'"><span class="secno">7.3 </span>'bookmark-state'</a></ol></li>
 <li><a href="#page-groups"><span class="secno">8 </span>Page groups</a></li>
 <li><a href="#selecting-pages"><span class="secno">9 </span>Selecting pages</a>
  <ol>
   <li><a href="#selecting-elements-within-pages-and-columns"><span class="secno">9.1 </span>Selecting elements within pages and columns</a></ol></li>
 <li><a href="#baseline-alignment"><span class="secno">10 </span>Baseline alignment</a>
  <ol>
   <li><a href="#idea-1"><span class="secno">10.1 </span>Idea 1</a></li>
   <li><a href="#idea-2"><span class="secno">10.2 </span>Idea 2</a></li>
   <li><a href="#idea-3"><span class="secno">10.3 </span>Idea 3</a></li>
   <li><a href="#idea-3-0"><span class="secno">10.4 </span>Idea 3</a></ol></li>
 <li><a href="#character-substitution"><span class="secno">11 </span>Character substitution</a></li>
 <li><a href="#appendix-a:-default-style-sheet"><span class="secno">12 </span>Appendix A: Default style sheet</a></li>
 <li><a href="#references" class="no-num">References</a></li>
 <li><a href="#acknowledgments" class="no-num">Acknowledgments</a></ol>
<!--end-toc-->


<h2 class="no-num" id="goals">Goals</h2>

<p>The main goal of this specification is to enable authors to write books in HTML or other markup languages. Book publishing is a craft with long traditions and certain formatting conventions have developed over time. This specification adds functionality to CSS so that style sheets can express commonly used features in printed books, on-screen books, and page description languages.


<h2 id="conformance"><span class="secno">1 </span>Conformance</h2>

<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this specification are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<a href="#refsRFC2119">[RFC2119]</a>

<p>Conformance requirements phrased as algorithms or specific steps
may be implemented in any manner, so long as the end result is
equivalent.

<p id="hardwareLimitations">User agents may impose
implementation-specific limits on otherwise unconstrained inputs,
e.g. to prevent denial of service attacks, to guard against running
out of memory, or to work around platform-specific limitations.



<h2 id="running-headers-and-footers"><span class="secno">2 </span>Running headers and footers</h2>

<p>To aid navigation in printed material, headers and footers are often
printed in the page margins. <a href="#refsCSSPAGE">[CSSPAGE]</a> describes how to place
headers and footers on a page, but not how to fetch headers and
footers from elements in the document. This specification offers two
ways to achieve this. The first mechanism is <dfn id="named-strings-0">named strings</dfn>
which <em>copies</em> the text (without style, structure, or replaced
content) of an element for later reuse in margin boxes. The second
mechanism is <dfn id="running-elements-0">running elements</dfn> which <em>moves</em> elements
(with style, structure, and replaced content) into a margin box.



<h3 id="named-strings"><span class="secno">2.1 </span>Named strings</h3>

<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/named-strings.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/named-strings-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/named-strings-pr.pdf" class="almost">PR</a>
</div>


<!--
<p>Named strings are discussed both in the CSS3 Generated and Replaced
Content (section 9) and in CSS3 Paged Media (several places). For a
proposed definition of the property, one has to go back to the <a href="http://www.w3.org/1999/06/WD-css3-page-19990623">CSS3 draft from 1999</a>
1999:
-->

<p>A Named string is a variable that can hold a string of text. Named
strings are created with the 'string-set' property which copies a
string of text into a named string. Only text is copied; not style,
structure, or replaced content.

<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-motivational.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-motivational-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-motivational-pr.pdf" class="pass">PR</a>
</div>

<div class="example">

<p>Consider this code:

<pre>h1 { string-set: heading content() }
</pre>

<p>Whenever an <code>h1</code> element is encountered,
its textual content is copied into a named string called
<em>heading</em>. The string can later be retrieved in the 'content'
property:

<pre>@page { @top-center { content: string(heading) }}
</pre>

</div>


<h4 id="setting-named-strings:-the-'string-set'-property"><span class="secno">2.1.1 </span>Setting named strings: the 'string-set' property</h4>

<table class="propdef">
    <tr>
      <td><em>Name:</em>
      <td><dfn id="string-set">string-set</dfn>
    <tr>
      <td><em>Value:</em>
      <td>[[ &lt;identifier&gt; &lt;content-list&gt;] [, &lt;identifier&gt; &lt;content-list&gt;]* ] | none
    <tr>
      <td><em>Initial:</em>
      <td>none
    <tr>
      <td><em>Applies to:</em>
      <td>all elements
    <tr>
      <td><em>Inherited:</em>
      <td>no
    <tr>
      <td><em>Percentages:</em>
      <td>N/A
    <tr>
      <td><em>Media:</em>
      <td>all
    <tr>
      <td><em>Computed value:</em>
      <td>as specified value
</table>

<p>The 'string-set' property accepts a comma-separated list of named
strings. Each named string is followed by a content list that
specifies which text to copy into the named string. Whenever an
element with value of 'string-set' different from ''none'' is
encountered, the named strings are assigned their respective value.

<p>&lt;content-list&gt; expands to one or more of these values, in any order:

<dl>

<dt>&lt;string&gt;
<dd>a string, e.g. "foo"

<dt>&lt;counter&gt;
<dd>the counter() or counters() function, as per <a href="http://www.w3.org/TR/CSS21/syndata.html#counter">CSS 2.1 section 4.3.5</a> <a href="#refsCSS">[CSS]</a>

<dt><!--content-element-->content(text)

<dd>The textual content of the element, not including the content of its ::before and ::after pseudo-element. The content of the element's descendants, including their respective ::before and ::after pseudo-elements, are included in the returned content. This is the default value, so ''content()'' is equivalent to ''content(text)''.

<dt><!--content-before-->content(before)

<dd>The textual content of the ::before pseudo-element of the element.

<dt><!--content-after-->content(after)

<dd>The textual content of the ::after pseudo-element of the element.

<dt><!--content-first-letter-->content(first-letter)

<dd>The first letter of the textual content of the element. The definition of a letter is the same as for the :first-letter pseudo-element, as per <a href="http://www.w3.org/TR/CSS2/selector.html#first-letter">CSS 2.1 section 5.12.2</a>.

</dl>


<p>Named strings can only hold the result of one assignment; whenever
a new assignment is made to a named string, its old value is replaced.

<p class="note">User agents, however, must be able to remember the
several assignments as the ''string()'' functional value
(described below) can refer to different assignments.

<p>The scope of a named string is the page of the element to which the
'string-set' property is attached and subsequent pages.

<!--
<p>The name space of named strings is different from other sets of
names in CSS.
-->


<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-counter.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-counter-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-counter-pr.pdf" class="pass">PR</a>
</div>


<div class="example">
<pre>h2 {
  string-set: header "Chapter " counter(header) ": " content();
  counter-increment: header;
}

&lt;h2&gt;Europa&lt;/h2&gt;
</pre>

<p>Note that the string called "header" is different from the counter with the same name. The above code may result in the string called "header" is set to "Chapter 1: Europa".

</div>


<p>The textual content of the named string is processed as if 'white-space: normal' has been set.

<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-white-space.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-white-space-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/string-set-set-white-space-pr.pdf" class="pass">PR</a>
</div>

<div class="example">
<p>In this example, the header will consist of three words ("In the begninning") with normal spacing between the words.
<pre>h2 {
  string-set: header "In " ' ' content();
}

&lt;h2&gt;   the    beginning&lt;/h2&gt;
</pre>
</div>


<div class="example">
<p>In this example, the named string called <em>index</em> will hold the first letter of &lt;dt&gt; elements.
<pre>dt { string-set: index first-letter }
</pre>
<p>One-letter running headers are often used in dictionaries. 
</div>

<p>The textual content is copied regardless of values on other CSS properties. 

<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-other-declarations.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-other-declarations-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/e-string-set-other-declarations-pr.pdf" class="pass">PR</a>
</div>

<div class="example">
<p>In this example, only the last declaration has an effect on the named string:

<pre>title {
  display: none;
  content: "foo"; 
  text-transform: uppercase;
  text-replace: "foo" "bar";
  string-set: tittel content();
}
</pre>
</div>


<h4 id="using-named-strings"><span class="secno">2.1.2 </span>Using named strings</h4>

<p>The content of named strings can be recalled by using the
''string()'' value on the 'content' property. The ''string()'' value has
one required argument: the name of the string.

<div class="example">
<pre>@page { @top-center { content: string(header) }}
@page { @right-middle { content: string(index) }}
@page { @top-left { content: string(entry) }}
h1 { string-set: header "Chapter " counter(chapter) content() }
dt { string-set: index first-letter, entry content() }
</pre>
<!--h1 { string-set: header "Chapter " counter(chapter) contents }
dt { string-set: index content-first-letter, entry contents }-->

</div>

<p>If the value of the named string is changed by an element on a certain
page, the named string may have several values on that page. In order to specify
which of these values should be used, an optional second argument is accepted
on the ''string()'' value. This argument can have one of four keywords:

<ul>
<li>''first'': the value of the first assignment on the page is used. If there is no assignment on the page, the named string's entry value is used. The entry value is the value held by the string at the end of the previous page. ''first'' is the default value.

<li>''start'': the value of the first assignment on the page is used if the element begins the page or the named string has not been assigned a value. Otherwise, the named string's entry value is used.

<li>''last'': the named string's exit value is used

<li>''first-except'': similar to ''first'', except on the page where the value was assigned. On that page, the empty string is used.

</ul>

<p>The assignment is considered to take place on the first page where a content box representing the element occurs. If the element does not have any content boxes (e.g., if 'display: none' is set), the assignment is considered to take place on the page where the first content box would have occured if the element had been in the normal flow.

<div class="example">
<p>In this example, the first term on the page will be shown in the top left corner and the last term on the page will be shown in the top right corner. In top center of the page, the first letter of first term will be shown.
<pre>@page { @top-left { content: string(term, first) }}
@page { @top-right { content: string(term, last) }}
@page { @top-center { content: string(index, first) }}
dt { string-set: index content(first-letter), term content(text) }
</pre>
</div>

<div class="example">

<p>Given this CSS code:

<pre>h2 { string-set: header content() }
</pre>

<p>The value of the <em>header</em> string 

<table class="string-set-example">
<tr>
<td>page#<td>HTML code<td>first<td>start<td>last<td>first-except

<tr>
<td>1
<td>
<pre>&lt;h1&gt;Continents&lt;/h1&gt;
...
&lt;h2&gt;Africa&lt;/h2&gt;
...
...
</pre>
<td>Africa
<td>Africa
<td>Africa
<td>


<tr>
<td>2
<td>
<pre>...
&lt;h2&gt;Americas&lt;/h2&gt;
...
&lt;h2&gt;Asia&lt;/h2&gt;
...
</pre>
<td>Americas
<td>Africa
<td>Asia
<td>


<tr>
<td>3
<td>
<pre>...
...
...
...
</pre>
<td>Asia
<td>Asia
<td>Asia
<td>Asia

<tr>
<td>4
<td>
<pre>&lt;h2&gt;Europe&lt;/h2&gt;
...
&lt;h2&gt;Oceania&lt;/h2&gt;
..

</pre>
<td>Europe
<td>Europe
<td>Oceania
<td>
</table>

</div>


<div class="example">
<p>In this example, the term that is being described at the start of the page is shown in the top left header.
<pre>@page { @top-left { content: string(term, start) }}
dt { string-set: term content() }
</pre>
</div>

<div class="example">
<pre>@page { @top-left { content: string(term, first) }}
@page { @top-right { content: string(term, last) }}
@page { @top-center { content: string(index, first) }}
dt { string-set: index content(first-letter), term content(text) }
</pre>
</div>



<div class="example">
<p>In this example, the header in the top center will be blank on pages where 'h1' elements appear. On other pages, the string of the previous 'h1' element will be shown.
<pre>@page { @top-center { content: string(chapter, first-except) }}
h1 { string-set: chapter content() }
</pre>
</div>

<p>If the named string referred to in a 'string()' value has not been
assigned a value, the empty string is used.


<h3 id="running-elements"><span class="secno">2.2 </span>Running elements</h3>

<p>Named strings, as described above, can only hold textual content; any
style, structure or replaced content associated with the element is
ignored. To overcome this limitation, a way of moving elements into
running headers and footers is introduced.

<p>Elements that are moved into headers and footers are repeated on
several pages; they are said to be <em>running elements</em>. To
support running elements, a new value – running() – is
introduced on the 'position' property. It has one required argument:
the name by which the running element can be referred to. A running
element is not shown in its natural place; there it is treated as if
'display: none' had been set. Instead, the running element is
displayed when referred to by the ''element()'' value.

<p>Like counters and named strings, the name of a running element is chosen by
the style sheet author, and the names have a separate namespace. A
running element can hold one element, including its pseudo-elements
and its descendants. Whenever a new element is assigned to a running
element, the old element is lost.

<p class="note">User agents, however, must be able to remember the
result of more than one assignment as the ''element()'' value
(described below) can refer to different assignments.

<p>Running elements inherit through their normal place in the
structure of the document.


<div class="example">
<pre>title { position: running(header) }
@page { @top-center {
  content: element(header) }
}
</pre>
</div>

<!--
<div class="example remove">
<p>In this example, the element is copied into the running header but it also keeps its normal place.

<pre>
title { position: running(header), normal }
@page { @top-center {
  content: element(header) }
}
</pre>
</div>
-->


<p>Like the ''string()'' value, the ''element()'' value accepts an
optional second argument:

<dl>
<dt>''start''
<dt>''first''
<dt>''last''
<dt>''first-except''
</dt></dl>

<p>The keywords have the same meaning as for the ''string()'' value. 

<p>The ''element()'' value cannot be combined with any other values.

<div class="example">
<p>In this example, the header is hidden from view in all media types
except print. On printed pages, the header is displayed top center on
all pages, except where h1 elements appear.

<pre>&lt;style&gt;
  div.header { display: none }
  @media print {
  div.header {
    display: block;
    position: running(header);
  }
  @page { @top-center { content: element(header, first-except) }}
&lt;/style&gt;
...
&lt;div class="header"&gt;Introduction&lt;/div&gt;
&lt;h1 class="chapter"&gt;An introduction&lt;/div&gt;

</pre>
</div>

<div class="example">
<p>This code illustrates how to change the running header on one page in the middle of a run of pages:

<pre>...
&lt;style&gt;
@page { @top-center {
  content: element(header, first) }}
.header { position: running(header) }
.once { font-weight: bold }
&lt;/style&gt;
...
&lt;div class="header"&gt;Not now&lt;/div&gt;
&lt;p&gt;Da di ha di da di ...
  &lt;span class="header once"&gt;NOW!&lt;/span&gt;
  &lt;span class="header"&gt;Not now&lt;/span&gt;
  ... da di ha di hum.&lt;/p&gt;
...
</pre>

The header is "Not now" from the outset, due to the "div" element. The
first "span" element changes it to "<b>NOW!</b>" on the page where the
"span" element would have appeared. The second "span" element, which
would have appeared on the same page as the first is not used because the
''first'' keyword has been specified. However, the second "span"
element still sets the exit value for "header" and this value is
used on subsequent pages.
</div>



<h2 id="leaders"><span class="secno">3 </span>Leaders</h2>

<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/leaders.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/leaders-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/leaders-pr.pdf" class="almost">PR</a>
</div>


<p>A leader is a visual pattern that guides the eye. Typically,
leaders are used to visually connect an entry in a list with a
corresponding code. For example, there are often leaders between
titles and page numbers in a table of contents (TOC). Another example
is the phone book where there are leaders between a name and a
telephone number.

<p>In CSS3, a leader is composed of series of glyphs through the
''leader()'' value on the 'content' property. The functional notation
accepts two values. The first describes the glyph pattern that makes up the
leader. These values are allowed:

<ul>
<li>leader(dotted)
<li>leader(solid)
<li>leader(space)
<li>leader(&lt;string&gt;)
</ul>

<p>Using the keyword values is equivalent to setting a string value.
The table below shows the equivalents:

<table class="border">
<tr><th>Keyword<th>String<th>Unicode characters
<tr><td>leader(dotted)<td>leader('. ')<td>\002E \0020
<tr><td>leader(solid)<td>leader('_')<td>\005F
<tr><td>leader(space)<td>leader(' ')<td>\0020
</table>


<p>When possible, User Agents should align corresponding glyphs from the
leader pattern of consecutive lines.

<p>The string inside the parenthesis is called the <em>leader string</em>.

<p>In its simplest form, the 'content' property only takes one
''leader()'' value:

<div class="example">
<pre>heading::after { content: leader(dotted) }
</pre>
</div>

<p>The leader string must be shown in full at least once and this
establishes the minimum length of the leader. To fill the available
space, the leader string is repeated as many times as possible in the
writing direction. At the end of the leader, a partial string pattern
may be shown. White space in the leader string is collapsed according
to the values on white-space properties.

<!-- <span class="issue">Or, partial strings be avoided?</span> -->
<!--<p class="issue">Should other properties influence the appearance of leaders?-->

<p>These properties influence the appearance of leaders: all font
properties, text properties, 'letter-spacing', white-space properties,
background properties, and 'color'.


<div class="example">

<p>In a more complex example, the 'leader' value is combined with other
values on the 'content' property:

<pre>ul.toc a::after {
  content: leader(". . . ") target-counter(attr(href url), page);
}
</pre>
</div>

<p>If the content connected by a leader end up on different lines, the
leader will be present on all lines. Each leader fragment honors the
minimum length of the leader.

<div class="example">
<p>Consider this code:

<pre>&lt;style&gt;
.name::after { content: leader(dotted) }
&lt;/style&gt;
&lt;div class="entry"&gt;
&lt;span class="name"&gt;John Doe&lt;/span&gt;
&lt;span class="number"&gt;123456789&lt;/span&gt;
&lt;/div&gt;
</pre>

<p>If the name and number end up on different lines (e.g., in a narrow column), it may be formatted like this:

<pre>John Doe....
...123456789
</pre>
</div>

<p>To determine the length of the leaders, user agents must do the
following for each line:

<ol>
<li>Lay out the content with leaders of minimum lengths

<li>Determine the empty space left on the line.

<li>Distribute the empty space between the leaders on the line. Glyphs
must not be shown partially. All leaders on the line should, to the
extent possible, have the same length. This may not always be possible
as the minimum leader length must be honored.

<li>Fill the empty space with the specified leader pattern.
</ol>


<div class="example">
<p>Consider this code:

<pre>&lt;style&gt;
cite::before { content: leader('  ') }
&lt;/style&gt;
&lt;blockquote&gt;
  For a moment, nothing happend. 
  Then, after a second or so, 
  nothing continued to happen.
    &lt;cite&gt;Douglas Adams&lt;/cite&gt;
&lt;/blockquote&gt;
</pre>

<p>Depending on the width of the containing block, this may be rendered as:

<pre> |For a moment, nothing happend.  |
 |Then, after a second or so,     |
 |nothing continued to happen.    |
 |                   Douglas Adams|


</pre>

<!--
<p>To indicate that <q>John Johnson</q> should be kept on one line,
this rule can be added to the style sheet:

<pre>
cite { text-wrap: suppress }
</pre>

<p>Until 'text-wrap' is widely supported, this rule can also be used:

<pre>
cite { white-space: nowrap }
</pre>
-->

<p>If the containing block is wider, this may be the resultant presentation:

<pre> |For a moment, nothing happend. Then,    |
 |after a second or so, nothing continued |
 |to happen.                 Douglas Adams|
</pre>

</div>


<h2 id="cross-references"><span class="secno">4 </span>Cross-references</h2>

<p>It is common to refer to other parts of a document by
way of a section number (e.g., "See section 3.4.1"), a page number
(e.g., "See discussion on page 72"), or a string (e.g., "See the
chapter on Europe"). Being able to resolve these cross-references
automatically saves time and reduces the number of errors.

<h3 id="the-''target-counter''-and-''target-counters''-values"><span class="secno">4.1 </span>The ''target-counter'' and ''target-counters'' values</h3>

<p>Numerical cross-references are generated by ''target-counter()''
and ''target-counters()'' values that fetch the value of a counter at
the target end of the link. These functions are similar to the
''counter()'' and ''counters()'' functions, except that they fetch
counter values from remote elements. ''target-counter()'' has two
required arguments: the url of the link, and the name of a counter.
''target-counters()'' has three required arguments: the url of the
link, the name of a counter, and a separator string. Both functions
accepts an optional argument at the end that describes which list
style type to use when presenting the resulting number; ''decimal''
being the default.

<div class="example">
<p>This style sheet specifies that a string like " (see page 72)"
is added after a link:

<pre>a::after { content: "(see page " target-counter(attr(href url), page, decimal) ")" }
</pre>
</div>


<div class="example">
<p>This style sheet specifies that a string like " (see section 1.3.5)"
is added after a link:

<pre>a::after { content: "(see section " target-counters(attr(href url), section, ".", decimal) ")" }
</pre>
</div>


<h3 id="the-''target-text''-value"><span class="secno">4.2 </span>The ''target-text'' value</h3>

<p>Textual cross-references are generated by ''target-text()'' which
fetches the textual content from the target end of the link. Only text
is copied; not style, structure, or replaced content.
''target-text()'' has one required argument: the url of the link. An
optional second argument specifies exactly which content is fetched.
There are four possible values: <!--''contents'',--> ''content'',
''before'', ''after'', ''first-letter''; these
keywords are defined above.


<div class="example">
<p>To generate this text:

<blockquote>
<p>See Chapter 3 ("A better way") on page 31 for an in-depth evaluation.
</blockquote>

from this markup:

<pre>&lt;p&gt;See &lt;a href="#chx"&gt;this chapter&lt;/a&gt; for an in-depth evaluation.
...
&lt;h2 id="chx"&gt;A better way&lt;/h2&gt;
</pre>

this CSS code can be used:

<pre>h2 { counter-increment: chapter }
a { content: "Chapter " target-counter(attr(href url), chapter)
   ' ("'  target-text(attr(href url), content) '") on page '
   target-counter(attr(href url), page);
</pre>
</div>


<h2 id="footnotes"><span class="secno">5 </span>Footnotes</h2>


<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/footnontes.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/footnotes-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/footnotes-pr.pdf" class="pass">PR</a>
</div>


<p>When an element is turned into a footnote, certain things
happen: the element is moved to the footnote area, a footnote call is
left behind in its place, a footnote marker is displayed before the
element, and the footnote counter is incremented.

<p>A footnote is a note typically placed at the bottom of a page that
comments on, or cites, a reference. References to footnotes are marked
with a <em>footnote call</em> in the main text which corresponds to
a <em>footnote marker</em> in the <em>footnote area</em>. The
rendering of footnotes is complex. As far as possible, footnotes try
to reuse other parts of CSS. However, due to the typographic
traditions of footnotes, some new functionality is required to support
footnotes in CSS:

<ul>
<li>one new value on the 'float' property: ''footnote''
<li>one new page area: ''@footnote''
<li>two new pseudo-elements: ''::footnote-call'' and ''::footnote-marker''
<li>one predefined counter: ''footnote''
<li class="remove">one new value on the 'content' property: ''target-pull()''
<li>border segments (see <a href="http://dev.w3.org/csswg/css-backgrounds-4/#border-clip">border-clip</a>)
<li><a href="http://www.w3.org/TR/2011/WD-css3-lists-20110524/#super-decimal">super-decimal</a>
<!--<li>two new 'list-style-type' values: ''super-decimal'', and symbol(...)-->
</ul>


<div class="example">
<p>In its simplest form, making a footnote is simple.

<pre>&lt;style&gt;
.footnote { float: footnote }
&lt;/style&gt;

&lt;p&gt;A sentence consists of words. &lt;span class="footnote"&gt;Most often.&lt;/span&gt;.
</pre>

<p>In this example, the text <q>Most often.</q> will be placed in a
footnote. A note-call will be left behind in the main text and a
corresponding marker will be shown next to the footnote. Here is one
possible rendering:

<pre>A sentence consists of words. ¹

¹ Most often.
</pre>

</div>


<!--
<div class="example remove">

<p>To support legacy browsers, it is often better to make a link to
the note rather than including the text inline. This example shows how
to fetch the content of a note and place it in a footnote.

<pre>
&lt;style>
@media print {
  .footnote {
    float: footnote;
    content: target-pull(attr(href url)) }
  .call { display: none }
}
&lt;/style>
...
&lt;p>A sentence consists of words&lt;a class="footnote" href="#words"> [3]&lt;/a>.
...
&lt;p id=words>&lt;span class="call">[3]&lt;/span> Most often.
</pre>

<p class=issue>define ''target-pull''

<p>When shown in a legacy browser, the content of the element will be
shown as a clickable link to an endnote. When printed according to
this specification, there will be a footnote:

<pre>
A sentence consists of words&#xB9;.

&#xB9; Most often.
</pre>
</div>
-->

<div class="example">
Consider this markup:
<pre>&lt;p&gt;Sorry, &lt;span title="This is, of course, a lie."&gt;we're closing for lunch&lt;/span&gt;.
</pre>

<p>The content of the "title" attribute can be turned into a footnote with this code:

<pre>span[title]::after {
  content: attr(title);
  float: footnote;
}
</pre>
</div>


<h3 id="turning-elements-into-footnotes"><span class="secno">5.1 </span>Turning elements into footnotes</h3>

<p>An element with ''float: footnote'' (called a <em>footnote
element</em>) is moved to the <em>footnote area</em> and a <em>footnote-call</em>
pseudo-element is put in its original place.

<div class="example">
<pre>span.footnote {
  float: footnote;
}
</pre>
</div>

<p>Footnote elements are presented inside the <em>footnote area</em>,
but they inherit through their normal place in the structure of the
document.

<!--
<div class=remove>
<p>The 'display' property on footnote elements is ignored. Instead,
the value of the 'display' property in the @footnote context
determines if footnotes are block or inline elements.

<div class="example">
<p>In this example, the footnotes are displayed inline:

<pre>
@footnote {
  display: inline;
}
span.footnote {
  float: footnote;
}
</pre>

<p>Here is one possible presentation of inline footnotes:

<pre>
&#xB9; The first footnote. &#xBA; The second footnote.
</pre>
</div>

</div>
-->
<!--
<p class=issue>Another way to achieve this would be to introduce different keywords for inline and block footnotes (e.g., float: footnote-inline, float: footnote-block).
-->

<p>For each new footnote element, the ''footnote'' counter is automatically
incremented.


<h3 id="the-footnote-area"><span class="secno">5.2 </span>The footnote area</h3>

<p>All elements with ''float: footnote'' are moved to the <em>footnote
area</em>. The footnote area is described by an @footnote-rule inside
the @page-rule. By default, the footnote area appears at the bottom of
the page, but it can be positioned in other places.

<div class="example">

<p>These rules place the footnote area at the bottom of the page,
spanning all columns of the outermost multicol element:

<pre>@page {
  @footnote {
    float: bottom;
    column-span: all;
  }
}
</pre>

<p>The code above is part of the default style sheet.
</div>


<div class="example">
<p>These rules place the footnote area at the bottom of the first column:

<pre>@page {
  @footnote {
    float: bottom;
    column-span: none;
    width: 100%;
  }
}
</pre>
</div>

<div class="example">
<p>These rules place the footnote area at the bottom of the page, spanning all columns. Also, the footnote area is split into three columns which the footnotes are flowed into:

<pre>@page {
  @footnote {
    float: bottom;
    column-span: all;
    columns: 3; 
  }
}
</pre>
</div>

<div class="example">
<p>This code places the footnote area at the bottom of the last column of the outermost multicol element:

<pre>@page {
  @footnote {
    float: bottom;
    float-defer: last;
  }
}
</pre>

</div>

<p>The content of the footnote area is considered to come before other
content which may compete for the same space on the same page.

<div class="example">
<pre>@page { @footnote { float: bottom; column-span: all }}
div.figure { float: bottom }
</pre>

<p>If figures and footnotes are on the same page, the footnotes will appear below the figures as they are floated to the bottom before the figures.
</div>


<p>Potentially, every page has a footnote area. If there
are no footnotes on the page, the footnote area will not take up any
space. If there are footnotes on a page, the layout of the footnote
area will be determined by the properties/values set on it, and by the
footnote elements inside it.

<p>These properties apply to the footnote area: 'content', 'border',
'padding', 'margin', 'height', 'width', 'max-height', 'max-width',
'min-height', 'min-width', the background properties.

<!--
<p class="note">In published books, it is customary for the footnote
area to be limited to less than half the height of the page area. Long
footnotes may need more space, and the customary solution is for
footnotes to span several pages. To achieve this, the 'max-height'
property should be used. However, footnotes spanning several pages is
an advanced feature which is not a conformance requirement for this
specification.
-->


<div class="example">
<p>This example uses some of the applicable properties on @footnote:

<pre>@footnote {
  margin-top: 0.5em;
  border-top: thin solid black;
  border-clip: 4em;
  padding-top: 0.5em;
}
</pre>

<p>The result of this code is a footnote area separated from other content above it by margin, border and padding. Only 4em of the border is visible due to the 'border-clip' property, which is defined in <a href="http://dev.w3.org/csswg/css4-background/">CSS Backgrounds and Borders Module Level 4</a>.   <!--[[!CSS4BACKGROUND]]-->.

</div>


<!--
<p class="issue">Footnotes in tables and floats may be problematic. In
some cases, the author may want the footnote to go at the end of the
table or float instead of the bottom of the page.
-->

<h3 id="footnote-calls"><span class="secno">5.3 </span>Footnote calls</h3>

<p>When an element is moved to the footnote area,
a <em>footnote-call</em> is left behind. By default, User Agents must
behave as if this code is part of the default style sheet:

<pre>::footnote-call {
  content: counter(footnote, super-decimal);
}
</pre>

<p>The resulting note call is a super-script decimal number.


<h3 id="footnote-markers"><span class="secno">5.4 </span>Footnote markers</h3>

<p>A ::footnote-marker pseudo-element is added to each footnote
element, in the same place, and replacing, the ::before
pseudo-element. User agents must, by default, show the "footnote"
counter in the footnote-marker.

<div class="example">
<p>User Agents may display footnote-calls and footnote-markers this way by default:

<pre>::footnote-call {
  content: counter(footnote, super-decimal);
}
::footnote-marker {
  content: counter(footnote, super-decimal);
}
</pre>
</div>

<p>Marker elements are discussed in more detail in the CSS Lists
module [CSSLIST]. One suggested change to that module is to honor
the value of 'list-style-position' on the ::footnote-marker
pseudo-element itself rather than the corresponding list-item element.
Further, one clarification to the horizontal placement of the marker
is suggested: the <em>margin</em> box of the marker box is
horizontally aligned with the start of the line box.


<h3 id="counting-footnotes"><span class="secno">5.5 </span>Counting footnotes</h3>

<p>The "footnote" counter is automatically incremented each time a
footnote is generated. That is, the "footnote" counter is incremented
by one each time an element with ''float: footnote'' appears.

<p>The footnote counter can be reset with the 'counter-reset' property.

<div class="example">
This code resets the "footnote" counter on a per-page page basis:
<pre>@page { counter-reset: footnote }
</pre>
</div>


<!--
<p>The 'counter-increment' property can be set in the @footnote rule.
Each time an element with 'float: footnote' is found, the corresponding
counter is incremented.

<div class="example">
<p>This rule is part of the default style sheet:

<pre>
@page {
  @footnote {
    counter-increment: footnote;
  }
}
</pre>

As a result, the "footnote" counter is incremented each time a footnote is generated.
</div>
-->




<h3 id="laying-out-footnotes"><span class="secno">5.6 </span>Laying out footnotes</h3>

<p>Footnotes must appear as early as possible under the following constraints:

<ol>

<li>A footnote marker may not appear on an earlier page than the
    footnote call.

<li>Footnotes may not appear out of document order.

<!--<span class="issue">(What order is that: the document order or the visual order?
    Probably the document order, the same order as the footnote counter
    values, although the visual order of the footnote calls may be
    different, due to their occurrence in positioned and floating
    elements.)</span>-->

<li>The footnote area is limited in size by 'max-height', unless the
    page contains only footnotes. (E.g., if at the end of the document
    there are still footnotes unprinted, the User Agent can use the whole page to
    display footnotes.)

<li>If there is a footnote call on a page, the footnote area may not
    be empty, unless its 'max-height' is too small.

</ol>


<h2 id="sidenotes"><span class="secno">6 </span>Sidenotes</h2>

<p>Sidenotes are supported the same way as footnotes; only the name
and the settings in the default style sheet differentiates the two.

<div class="example">
<p>This example moves images to the outside margin of pages:

<pre>@page :left {
  margin-left: 10em;
  @sidenote { position: absolute; left: -8em; top: 0; width: 6em; height: auto }
}
@page :right {
  margin-right: 10em;
  @sidenote { position: fixed; right: -8em; top: 0; width: 6em; height: auto }
}

img { float: sidenote }
</pre>

<p>It is important to note that it is the sidenote area that is descibed by @sidenote, and not the elements that are floated into the sidenote area. 
</div>

<p class="XXX">It should be possible to have all sidenotes go into a sidenote area, like footnotes. It should also be possible to have sidenotes on the side of the text, vertically aligned with the anchoring point. 

<p class="XXX">Should there be a mechanism to create new areas like footnote/sidenote, or are two predefinded areas enough? One could also define sidnotes in a generic way, e.g. "float: to(sidenote)" 


<h2 id="bookmarks"><span class="secno">7 </span>Bookmarks</h2>

<div class="code-example">
<a href="http://people.opera.com/howcome/2013/tests/books/bookmarks.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/bookmarks-ah.pdf" class="pass">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/bookmarks-pr.pdf" class="pass">PR</a>
</div>

<p>Some document formats have the capability to represent bookmarks
into the document. These bookmarks can e.g. be used to show an outline
or an index of the document. Bookmarks are typically shown outside the
document itself, often in a tree-structured and clickable table of
contents. To generate bookmarks, these properties are defined:
'bookmark-level', 'bookmark-label', and 'bookmark-state'. 

<h3 id="'bookmark-level'"><span class="secno">7.1 </span>'bookmark-level'</h3>

<table class="propdef">
    <tr>
      <td><em>Name:</em>
      <td><dfn id="bookmark-level">bookmark-level</dfn>
    <tr>
      <td><em>Value:</em>
      <td>none | &lt;integer&gt;
    <tr>
      <td><em>Initial:</em>
      <td>none
    <tr>
      <td><em>Applies to:</em>
      <td>all elements
    <tr>
      <td><em>Inherited:</em>
      <td>no
    <tr>
      <td><em>Percentages:</em>
      <td>N/A
    <tr>
      <td><em>Media:</em>
      <td>all
    <tr>
      <td><em>Computed value:</em>
      <td>specified value
</table>

<p>This property describes what level a certain bookmark has in a
hierarchical bookmark structure. The values are:

<dl>

<dt>none

<dd>no bookmark is generated

<dt>&lt;integer&gt;

<dd>Indicates the level of the bookmark; the highest level is ''1'', then ''2'', ''3'' etc. Zero and negative values are not allowed.

</dl>


<h3 id="'bookmark-label'"><span class="secno">7.2 </span>'bookmark-label'</h3>

<table class="propdef">
    <tr>
      <td><em>Name:</em>
      <td><dfn id="bookmark-label">bookmark-label</dfn>
    <tr>
      <td><em>Value:</em>
      <td>&lt;content-list&gt; | none
    <tr>
      <td><em>Initial:</em>
      <td>none
    <tr>
      <td><em>Applies to:</em>
      <td>all elements
    <tr>
      <td><em>Inherited:</em>
      <td>no
    <tr>
      <td><em>Percentages:</em>
      <td>N/A
    <tr>
      <td><em>Media:</em>
      <td>all
    <tr>
      <td><em>Computed value:</em>
      <td>specified value
</table>

<p>This property specifies the label of the bookmark, i.e., the text that will represent the bookmark in the bookmark structure. This properly will only be consulted if 'bookmark-level' is different from 'none'. The values are:

<dl>

<dt>&lt;content-list&gt;

<dd>as defined on the 'string-set' property

<dt>none

<dd>no bookmark is generated

</dl>


<div class="example">
<p>This code would generate a simple hierachical outline of a document that uses three heading levels:

<pre>h1 { bookmark-level: 1 }
h2 { bookmark-level: 2 }
h3 { bookmark-level: 3 }
h1, h2, h3 { bookmark-label: content() }
</pre>
</div>

<div class="example">
<p>This code will make bookmarks from links. 
<pre>a[href] { bookmark-label: attr(href); bookmark-level: 1 }
a[title] { bookmark-label: attr(title); bookmark-level: 1 }
</pre>
<p>If a <code>title</code> attribute exisits, its value will be used as the bookmark label. Otherwisee, the URL is used. 
</div>

<div class="example">
<p>This code specififies a string to be used as the bookmark label:
<pre>#frog { bookmark-label: "The green frog"; bookmark-level: 1 }
</pre>
</div>

<div class="example">
<p>Consider this code:
<pre>h1 { bookmark-label: content(before) ": " content(); bookmark-level: 1 }
h1:before { content: "Chapter" }

&lt;h1&gt;Africa&lt;/h1&gt;
</pre>

<p>The resulting bookmark would be: "Chapter: Africa".
</div>


<h3 id="'bookmark-state'"><span class="secno">7.3 </span>'bookmark-state'</h3>


<table class="propdef">
    <tr>
      <td><em>Name:</em>
      <td><dfn id="bookmark-state">bookmark-state</dfn>
    <tr>
      <td><em>Value:</em>
      <td>open | closed
    <tr>
      <td><em>Initial:</em>
      <td>open
    <tr>
      <td><em>Applies to:</em>
      <td>block-level elements
    <tr>
      <td><em>Inherited:</em>
      <td>no
    <tr>
      <td><em>Percentages:</em>
      <td>N/A
    <tr>
      <td><em>Media:</em>
      <td>all
    <tr>
      <td><em>Computed value:</em>
      <td>specified value
</table>

<p>A hierarchy of bookmarks may be shown in an open or closed state.
The user will typically be able to toggle the state to navigate in the
bookmarks. This property describes the initial state of a bookmark.

<div>
<p>In this example, h1 and h2 elements are set to have an open initial bookmark stat, all other elements will be closed initially:
<pre>* { bookmark-state: closed }
h1, h2 { bookmark-state: open }
</pre>
</div>


<h2 id="page-groups"><span class="secno">8 </span>Page groups</h2>

<p>Named pages can appear in sequence, stemming from different elements. A sequnce of named pages with the same name is called a <em>page group</em>. The 'page-group' property expresses whether an element starts a new page group or not. 

<table class="propdef">
    <tr>
      <td><em>Name:</em>
      <td><dfn id="page-group">page-group</dfn>
    <tr>
      <td><em>Value:</em>
    <td>auto | start 
    <tr>
      <td><em>Initial:</em>
      <td>auto
    <tr>
      <td><em>Applies to:</em>
      <td>elements with 'page' value other than auto
    <tr>
      <td><em>Inherited:</em>
      <td>no
    <tr>
      <td><em>Percentages:</em>
      <td>N/A
    <tr>
      <td><em>Media:</em>
      <td>paged
    <tr>
      <td><em>Computed value:</em>
      <td>as specified
</table>

<p>This property determines whether the element starts a new page group or not. 

<dl>
<dt>auto
<dd>The element only starts a new page group if 'page' has a named page different from the the previous element.

<dt>start
<dd>The element always starts a new page group.

</dl>


<div class="example">

<p>In this example, each article starts a new page group so that the first page of each article has a pink background.

<pre>@page funky:first {
  background: pink;
}
article {
  page: funky;
  page-group: start;
}
</pre>

<p>Without the 'page-group: start' declaration, only the first page of the first article would be pink.

</div>



<h2 id="selecting-pages"><span class="secno">9 </span>Selecting pages</h2>

<p>In CSS2, <a href="http://www.w3.org/TR/CSS2/page.html#page-selectors">first, left and right pages</a> can be selected. This specification extends pages selectors with the <code>:nth()</code> functional notation. 


<div class="example">
<p>These are equivalent:
<pre>@page :first { background: lime } 
@page :nth(1) { background: lime } 
</pre>
</div>

<p>The grammar of allowed arguments to <code>nth()</code> is the same as the <a href="http://www.w3.org/TR/css3-selectors/#nth-child-pseudo">nth-child() pseudo-class</a>. 

<div class="example">
<p>In this example, pages in a document will cycle through pink, lime and white backgrounds:
<pre>@page :nth(3n) { background: pink }
@page :nth(3n+1)) { background: lime }
@page :nth(3n+2)) { background: white }
</pre>
</div>

<p><code>nth()</code> can be combined with other page selectors. 

<div class="example">
<pre>@page funky:nth(1) { background: pink }  /* select first page of every "funky" page group */
@page :first:nth(2)) { background: lime } /* selects nothing */
@page :right:nth(3n)) { background: lime } /* selects every third page, which also is a right page */
</pre>
</div>


<h3 id="selecting-elements-within-pages-and-columns"><span class="secno">9.1 </span>Selecting elements within pages and columns</h3>

<p class="XXX">This section is fairly sketchy.

<p>The 'page()' and 'column()' pseudo-elements allows the selection of
pages, columns, and elements within.


<div class="example">
<pre>article::column(2n) {     /* select every other column of an article */
  ...
}
</pre>
</div>

<div class="example">
<pre>div.chapter::column(3)       /* the 3rd column of the element */
div.chapter::column(2n)      /* all even columns of the element */
div.chapter::column(3+)      /* all columns but the 1st and 2nd */
div.chapter::column(2,2)     /* second column on second page */
div.chapter::column(*,2)     /* all columns on the second page */
div.chapter::column(1,*)     /* the first column on all pages */
</pre>
</div>


<div class="example">
<pre>article::page(left) {   /* select all left pages in an article */
  background: pink;
} 
</pre>
</div>


<div class="example">
<pre>article::page(left) p {   /* select all p elements that appear on left pages in an article */
  text-align: left;
} 
</pre>
</div>

<p>It is also possible to place the code inside @page:

<div class="example">
<p>These are identical:

<pre>@page :left {
  {
    p { text-align: left } 
  }
}

::page(left) p { text-align: left }
</pre>

<p class="XXX">Is "left" a pseudo-class or pseudo-element? In @page, ":left" is a pseudo-class. However, when we select elements on left pages, it acts like a pseudo-element.</p>

</div>




<div class="example">
<p>This syntax also allows the selection and styling of elements inside margin boxes:

<pre>@page :left {
  background: pink;            /* declaration applies to pages */
  {
    p { text-align: left }     /* declaration applies to elements on page */
  }
  @top-center {
    background: orange;        /* declaration applies to margin box */
    {
      p { text-align: left }   /* declaration applies to elements in margin box */
    }
  }
}
</pre>
</div>



<h2 id="baseline-alignment"><span class="secno">10 </span>Baseline alignment</h2>

<p class="XXX">This section is still searching for a solution. 

<p>To avoid <em>show-through</em>, where a printed line shows through to the other side of the sheet, baselines are often aligned. Also, in multi-column layouts, lines in adjacent columns are often aligned. To achive these kinds of aligements, a flag of some kind is needed to indicate that lines within an element should be alinged. This section sketches several ideas

<p class="note">This issue has also been <a href="http://lists.w3.org/Archives/Public/www-style/2009Jan/0010.html">discussed in the past</a>.

<h3 id="idea-1"><span class="secno">10.1 </span>Idea 1</h3>

<p>One possible solution can be found in <a href="http://www.w3.org/TR/css3-linebox/#line-stacking-strategy">CSS3 module: line</a>.

<div class="example">
<pre>article { 
  columns: 3; 
  line-stacking-strategy: grid-height;
}
</pre>
</div>

<p>When <code>line-stacking-strategy</code> is set to <code>grid-height</code>, the stack height of each line is the smallest multiple of the element's <code>line-height</code> computed value that can contain the block progression of all the inline elements on that line when those elements are properly aligned. The 'line-height' property value is ignored for inline elements. 

<p class="XXX">Where is the extra space placed? Above the line, below the line, or evenly distributed above/below?

<h3 id="idea-2"><span class="secno">10.2 </span>Idea 2</h3>

<p>Another possible solution is to say: 

<ol>
<li>For each block-level element, find the "natural" set of baselines given by the computed value of 'line-height' and the used font. 
<li>When baseline alignment in turned on, each line is placed on the closest "natural" baseline.
</ol>

<p>This could be achived with:

<div class="example">
<pre>article { 
  columns: 3; 
  line-stacking-strategy: baseline-alignment;
}
</pre>
</div>


<h3 id="idea-3"><span class="secno">10.3 </span>Idea 3</h3>

<p>One problem with both Idea 1 and Idea 2 is that all content is
aligend. This may not be desireable in all cases. For example, a
headline will typically use a larger font size and if all lines in the
headline are aligned with a "natural" baseline (or something similar),
lots of white space will be generated. Therefore, we need a way to turn 
off baseline alingement for certain elements. 

<div class="example">

<p>In this example, the <code>article</code> element defines a set baselines to be used by its own content as well as its child elements. Child elements can opt out of the scheme by setting <code>line-stacking: normal</code> (or something):

<pre>article { 
  columns: 3; 
  line-stacking: set-baselines;
}
article p { line-stacking: use-baselines }
article h1 { line-stacking: normal }
article img { display: block; vertical-align: bottom }
</pre>

<p>(In the code above, the 'vertical-align' property is used to declare where any extra space ends up; in this example it will end up above the image.)
</div>

<h3 id="idea-3-0"><span class="secno">10.4 </span>Idea 3</h3>

<p><a href="http://dev.w3.org/csswg/css-line-grid">CSS Line Grid Module</a>



<!--
<p class=note>A similar idea &mdash; 'line-stacking-strategy: grid-height' &mdash; was proposed in a <a href="http://www.w3.org/TR/css3-linebox/#line-stacking-strategy">previous version of the CSS3 line module</a>. The 'line-stacking-strategy' property is <a href="http://www.w3.org/TR/xsl/#line-stacking-strategy">used in XSL</a>.
-->


<!--
<p>In multi-column layouts, baselines are typically aligned between
adjacent columns. This gives the presentation a visual rythm, and text
in the end of the columns will be alignend. To support this, a new
value on the <span class=property>'line-box-contain'</span> property is
defined: ''line-grid'' (or, perhaps, ''gap'', ''crack'', ''snap'', ''snap-gap'', ''void'', ''grid'', ''snap-to-grid'').

<p>The value means that the height of the line in which the element
occurs should be rounded up to the smallest multiple of the used
'line-height' value on the containing block.

<div class=example>
<p>In this example, the stacking height of div.figure would be 30px (2 * 15px)

<pre>
div.multicol { line-height: 15px }
div.figure { height: 20px; line-box-contain: block inline replaced line-grid }
</pre>
</div>
-->
<!--
<p class=note>The <a href="http://dev.w3.org/csswg/css3-linebox/#LineStacking">line-box-contain</a> property is defined in <a href="http://dev.w3.org/csswg/css3-linebox">CSS3 module: line</a>.
-->
<!--
http://www.w3.org/Style/Group/css3-src/css3-linebox/Overview.html#LineStacking
-->

<h2 id="character-substitution"><span class="secno">11 </span>Character substitution</h2>

<p>It is sometimes convenient to replace one character or string with another without changing the source document. The ‘text-replace’ property offers a way to perform the replacement in the style sheet.

<table class="propdef">
<tr>
  <td><em>Name:</em> 
  <td><dfn id="text-replace">text-replace</dfn>

<tr>
  <td><em>Value:</em>
  <td> [&lt;string&gt; &lt;string&gt;]+ | none

<tr>
  <td><em>Initial:</em>
  <td>none

<tr>
  <td><em>Applies to:</em>
  <td>all elements

<tr>
  <td><em>Inherited:</em>
  <td>yes

<tr>
  <td><em>Percentages:</em>
  <td>N/A

<tr>
  <td><em>Media:</em>
  <td>visual

<tr>
  <td><em>Computed value:</em>
  <td>as specified value
</table>


<p>This property replaces all occurrences of a certain string with another string in the content of the element. The property accepts pairs of strings as value, in addition to the initial 'none' value. For each pair of strings, occurrences of the first string in the content will be replaced with the second string. If 'none' is specified, no replacements will occur.

<div class="code-example">

<a href="http://people.opera.com/howcome/2013/tests/books/e-character-substitution-motivational.html">html</a><br>
<a href="http://people.opera.com/howcome/2013/tests/books/e-character-substitution-motivational-ah.pdf" class="fail">AH</a>
<a href="http://people.opera.com/howcome/2013/tests/books/e-character-substitution-motivational-pr.pdf" class="pass">PR</a>
</div>


<div class="example">
<p>In this example, three consecutive period characters are replaced with an ellipsis character and the apostrophe character is replaced with a quotation character:

<pre>body { text-replace: "..." "\2026" "'" "\2019" }
</pre>

<p>As a result, the string "It's the beginning...!" will be changed to "It’s the beginning…!".
</div>

<!--
<div class=example>
<p>In this example, all references to &rsquo;Soviet Union' are replaced with &lsquo;<span class=property>Russia</span>&rsquo;.

<pre>
body { text-replace: "Soviet Union" "Russia" }
</pre>
</div>
-->

<p>Text replacements are applied sequentially, starting with the first pair of strings. 

<div class="example"> 

<p>The two rules below yield the same result. In the first rule all 'a' characters are converted to 'b'. Subsequently, all 'b' characters are converted to 'c'. In the second rule, all 'a' and 'b' characters are converted directly to 'c'.

<pre>body { text-replace: "a" "b" "b" "c" }
body { text-replace: "a" "c" "b" "c" }
</pre>
</div>

<p>The first string in a pair must have at least one character, while the second may be empty.

<div class="example">
<p>In this example, all 'a' characters are removed.

<pre>body { text-replace: "a" "" }
</pre>
</div>

<p>If the first string of a pair is empty, or if an odd number of strings has been specified, the whole value is ignored and no text replacements are performed. Text replacements do not occur across element boundaries. 

<div class="example">
<p>No text replacement will occur in this example:

<pre>h1 { text-replace: "foo" "bar" "" "foo" }   /* ignore value */
h2 { text-replace: "foo" "bar" "foobar" }   /* ignore value */
h3 { text-replace: "foobar" "barfoo" }      /* accept value, but ... */

&lt;h3&gt;foo&lt;span&gt;bar&lt;/span&gt;&lt;/h3&gt;    &lt;!-- ... start tag breaks string which would otherwise match --&gt;
</pre>
</div>

<p>This property is evaluated after the <span class="property">content</span> property, and before <span class="property">text-transform</span>.


<h2 id="appendix-a:-default-style-sheet"><span class="secno">12 </span>Appendix A: Default style sheet</h2>

<pre>@page {
  counter-reset: footnote;
  @footnote {
    counter-increment: footnote;
    float: bottom;
    column-span: all;
    height: auto;
  }
}

::footnote-call {
  counter-increment: footnote;
  content: counter(footnote, super-decimal);
}
::footnote-marker {
  content: counter(footnote, super-decimal);
}

h1 { bookmark-level: 1 }
h2 { bookmark-level: 2 }
h3 { bookmark-level: 3 }
h4 { bookmark-level: 4 }
h5 { bookmark-level: 5 }
h6 { bookmark-level: 6 }
</pre>

<h2 class="no-num" id="references">References</h2>

<div id="anolis-references"><dl><dt id="refsCSS">[CSS]
<dd><cite><a href="http://www.w3.org/TR/CSS2/">CSS</a></cite>, Bert Bos, Tantek Çelik, Ian Hickson et al.. W3C.

<dt id="refsCSSPAGE">[CSSPAGE]
<dd><cite><a href="http://dev.w3.org/csswg/css-page/">CSS Paged Media Module</a></cite>, Melinda Grant, Håkon Wium Lie, Elika J. Etemad et al.. W3C.

<dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

</dl></div>


<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>This document has been improved by Bert Bos, Michael Day, Melinda
Grant, David Baron, Markus Mielke, Steve Zilles, Ian Hickson, Elika
Etemad, Laurens Holst, Mike Bremford, Allan Sandfeld Jensen, Kelly
Miller, Werner Donné, Tarquin (Mark) Wilton-Jones, Michel Fortin,
Christian Roth, Brady Duga, Del Merritt, Ladd Van Tol, Tab Atkins Jr.,
Jacob Grundtvig Refstrup,  James Elmore, Ian Tindale, Murakami Shinyu, Paul E.
Merrell, Philip Taylor, Brad Kemper, Peter Linss, Daniel Glazman, Tantek Çelik, Florian Rivoal, Alex Mogilevsky, Simon Sapin, Cameron McCormack, Liam R E Quin, Peter Moulder, Morten Stenshorne, Rune Lillesveen, Lars Erik Bolstad, Anton Prowse, Michel Onoff</p>


